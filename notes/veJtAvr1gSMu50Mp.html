<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Test - Dendron</title>
  

  <link
    rel="shortcut icon"
    href="https://wiki.dendron.so/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://wiki.dendron.so/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://wiki.dendron.so/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://wiki.dendron.so/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
   
  
<meta name="description" content="Dendron is a local-first, markdown based, hierarchical note taking tool. It is meant to help you create, organize, and collaborate on knowledge bases of any size.">
<meta name="author" content="dendronhq">

<link rel="canonical" href="https://wiki.dendron.so/notes/veJtAvr1gSMu50Mp.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://wiki.dendron.so/notes/veJtAvr1gSMu50Mp.html">
<meta property="og:description" content="Dendron is a local-first, markdown based, hierarchical note taking tool. It is meant to help you create, organize, and collaborate on knowledge bases of any size.">
<meta property="og:image" content="https://wiki.dendron.so/logo.png">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@dendronhq">
<meta name="twitter:url" content="https://wiki.dendron.so/notes/veJtAvr1gSMu50Mp.html">
<meta name="twitter:description" content="Dendron is a local-first, markdown based, hierarchical note taking tool. It is meant to help you create, organize, and collaborate on knowledge bases of any size.">
<meta name="twitter:image" content="https://wiki.dendron.so/logo.png">


  <meta property="og:title" content="Test - Dendron" />
  <meta name="twitter:title" content="Test - Dendron" />
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-B0JN2HHCNY"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-B0JN2HHCNY');
  </script>
  
</head>



<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://wiki.dendron.so" class="site-title lh-tight">
  <div class="site-logo"></div>

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dendron" aria-label="Search Dendron" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://wiki.dendron.so/notes/32cdd4aa-d9f6-4582-8d0c-07f64a00299b.html">Packages</a></li><li class="breadcrumb-nav-list-item"><a href="https://wiki.dendron.so/notes/87d90002-f480-45eb-a8c4-d00df4d61557.html">Plugin Core</a></li><li class="breadcrumb-nav-list-item"><a href="https://wiki.dendron.so/notes/c84aa95c-83b9-4d52-90a1-eeec8f0ca84f.html">QA</a></li><li class="breadcrumb-nav-list-item">Test</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        
        

        

        

        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Test">
    
    <meta itemprop="datePublished" content="2021-07-24T15:28:29+00:00">
    <meta itemprop="dateModified" content="2021-10-07T08:04:12+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <h1 id="test"><a aria-hidden="true" class="anchor-heading" href="#test"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Test</h1>
<h2 id="writing-tests"><a aria-hidden="true" class="anchor-heading" href="#writing-tests"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Writing Tests</h2>
<p>To write a test, please use the <code>describeMultiWS</code> and <code>describeSingleWS</code>
functions. These work in the same way as mocha's <code>describe</code>, except that they
will set up a multi-vault or a single-vault workspace before running any tests.
You can then place <code>test</code>s inside to write your test cases, or even add
<code>describe</code>s to further organize your tests. Here's a <a href="https://github.com/dendronhq/dendron/blob/707ab9a5d8ed2e23ef96e6f813f7f6e11532db50/packages/plugin-core/src/test/suite-integ/WorkspaceInit.test.ts#L11:L33">simple example</a> of its usage:</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">// Need these imports</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> getDWorkspace <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"../../workspace"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> describeMultiWS<span class="token punctuation">,</span> setupBeforeAfter <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"../testUtilsV3"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> expect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"../testUtilsv2"</span><span class="token punctuation">;</span>
<span class="token comment">// Then create a test suite</span>
<span class="token function">suite</span><span class="token punctuation">(</span><span class="token string">"GIVEN testing code setupLegacyWorkspaceMulti"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// has to be function(), not arrow</span>
  <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token function">setupBeforeAfter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">describeMultiWS</span><span class="token punctuation">(</span>
    <span class="token string">"WHEN configured for NATIVE workspace"</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      preSetupHook<span class="token operator">:</span> <span class="token constant">ENGINE_HOOKS</span><span class="token punctuation">.</span><span class="token property-access">setupBasic</span><span class="token punctuation">,</span>
      ctx<span class="token punctuation">,</span>
      workspaceType<span class="token operator">:</span> <span class="token maybe-class-name">WorkspaceType</span><span class="token punctuation">.</span><span class="token constant">NATIVE</span><span class="token punctuation">,</span> <span class="token comment">// optional</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"THEN initializes correctly"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token comment">// You can access the workspace inside the test like this:</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> engine<span class="token punctuation">,</span> wsRoot<span class="token punctuation">,</span> vaults <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getDWorkspace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Then perform any actions and checks</span>
        <span class="token keyword">const</span> testNote <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token property-access">notes</span><span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>testNote<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"THEN is of NATIVE type"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getDWorkspace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token maybe-class-name">WorkspaceType</span><span class="token punctuation">.</span><span class="token constant">NATIVE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Note here that your tests can be regular functions with a <code>done</code> parameter like
this example, or they can be <code>async</code> functions without the <code>done</code>. Either will
work correctly, you can choose based on what you need for the function you are
testing.</p>
<p>The first object allows you to configure the workspace that's being created. It
has a lot of configuration options, see
<a href="https://github.com/dendronhq/dendron/blob/707ab9a5d8ed2e23ef96e6f813f7f6e11532db50/packages/plugin-core/src/test/testUtilsV3.ts#L95-L122">here</a>
and
<a href="https://github.com/dendronhq/dendron/blob/c87a049185eb9712b4b26f04922315ae1d102d02/packages/engine-test-utils/src/engine.ts#L44-L63">here</a>.
The most common ones used are the following ones:</p>
<h3 id="presetuphook"><a aria-hidden="true" class="anchor-heading" href="#presetuphook"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>preSetupHook</h3>
<p>Use this to set up the notes in the test workspace, and anything else that you
want to happen before the workspace setup is completed and the engine is
initialized. You can use a preset like this example, or you can also create notes yourself like <a href="https://github.com/dendronhq/dendron/blob/aadf3cd22efe7e8ec95301f286f6348378fba035/packages/plugin-core/src/test/suite-integ/CopyNoteLink.test.ts#L44:L51">this example</a>.</p>
<h3 id="workspacetype"><a aria-hidden="true" class="anchor-heading" href="#workspacetype"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>workspaceType</h3>
<p>This is optional. It allows you to set up a Code or Native workspace. It
defaults to Code. Native workspaces don't have the <code>dendron.code-workspace</code> file
and may have small differences in behavior.</p>
<h3 id="modconfigcb"><a aria-hidden="true" class="anchor-heading" href="#modconfigcb"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>modConfigCb</h3>
<p>You can use this callback to modify the <code>dendron.yml</code> configuration for the test workspace. See <a href="https://github.com/dendronhq/dendron/blob/1c734daa45cc1e655638d754267c6bdf5bdcab90/packages/plugin-core/src/test/suite-integ/CreateDailyJournalNote.test.ts#L115-L118">here for an example</a>.</p>
<h3 id="test-etiquette"><a aria-hidden="true" class="anchor-heading" href="#test-etiquette"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Test etiquette</h3>
<p>Your tests should follow a <a href="https://wiki.dendron.so/notes/m7iWYQRtPIYsIEd3zVPqg.html">BDD-Light</a> style. The example above shows how this can be accomplished. If you want to add some "AND" clauses, you can nest your tests inside <code>describe</code>s to achieve that.</p>
<p>Each test should test a single functionality. The tests should not depend on
each other: mocha allows skipping individual tests, and it should be possible to
skip one test without skipping the entire <code>describe*WS</code> block. To
achieve this, make sure that each tests does any necessary setup inside itself,
or in the <code>preSetupHook</code>.</p>
<p>If you need to do some action before all tests in <code>describe*WS</code> block and it needs to be done after the workspace has initialized, you can use the <code>before</code> mocha hook to do so. Simply add it inside <code>describe*WS</code> like this:</p>
<pre class="language-ts"><code class="language-ts"><span class="token function">describeMultiWS</span><span class="token punctuation">(</span>
    <span class="token string">"WHEN ..."</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token comment">// Action to do after workspace initialized, but before any tests are run</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"THEN ..."</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span> <span class="token comment">/* ... test code here */</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p>There's also a <code>beforeEach</code> mocha hook if this action needs to be repeated before each test.</p>
<h2 id="details"><a aria-hidden="true" class="anchor-heading" href="#details"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Details</h2>
<p>Note that VSCode uses <a href="https://mochajs.org/">mocha</a> as its default test runner whereas Dendron uses  <a href="https://jestjs.io/">jest</a>.</p>
<p>We shim the <a href="https://github.com/dendronhq/dendron/blob/master/packages/plugin-core/src/test/testUtilsv2.ts#L418:L418">jest methods</a> when testing the plugin though so that we can re-use the same logic between our non-vscode packages and the Dendron VSCode Plugin. </p>
<hr>
<h2 id="children"><a aria-hidden="true" class="anchor-heading" href="#children"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Children</h2>
<ol>
<li><a href="https://wiki.dendron.so/notes/CBX7ebh0upBfoeC2.html">Remote</a></li>
</ol><span id="navId" data="veJtAvr1gSMu50Mp"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>

        <div class="thumbs feedback_trigger right-bottom"></div>

        
          <hr>
          <footer>
            
            

            
              <div class="d-flex mt-2">
              <p class="text-small text-grey-dk-000 mb-0 mr-2">
                Page last modified: <span class="d-inline-block">10/7/2021</span>.
              </p>
            
                
                  <p class="text-small text-grey-dk-000 mb-0">
                    <a href="https://github.com/dendronhq/dendron-site/edit/master/vault/pkg.plugin-core.qa.test.md" id="edit-this-page">Edit this page on GitHub</a>
                  </p>
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>

</body>
</html>
